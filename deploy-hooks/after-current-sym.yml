---

- name: Install systemd unit file
  template:
    dest: /etc/systemd/system/{{ app_dir | basename }}.service
    src: puma.service.j2
  become: true
  register: puma_systemd

- name: Reload systemd
  command: systemctl daemon-reload
  changed_when: false
  when: puma_systemd.changed
  become: true

- name: Restart puma
  service:
    name: '{{ app_dir | basename }}.service'
    enabled: yes
    state: restarted
  become: true


